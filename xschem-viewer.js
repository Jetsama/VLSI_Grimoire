var ei=Object.defineProperty;var ti=(n,i,r)=>i in n?ei(n,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[i]=r;var oe=(n,i,r)=>ti(n,typeof i!="symbol"?i+"":i,r);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const f of s)if(f.type==="childList")for(const e of f.addedNodes)e.tagName==="LINK"&&e.rel==="modulepreload"&&l(e)}).observe(document,{childList:!0,subtree:!0});function r(s){const f={};return s.integrity&&(f.integrity=s.integrity),s.referrerPolicy&&(f.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?f.credentials="include":s.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function l(s){if(s.ep)return;s.ep=!0;const f=r(s);fetch(s.href,f)}})();const ri=(n,i)=>n===i,_t={equals:ri};let cn=vn;const we=1,Ft=2,fn={owned:null,cleanups:null,context:null,owner:null};var G=null;let yr=null,ni=null,j=null,z=null,ue=null,Wt=0;function ii(n,i){const r=j,l=G,s=n.length===0,f=i===void 0?l:i,e=s?fn:{owned:null,cleanups:null,context:f?f.context:null,owner:f},u=s?n:()=>n(()=>ye(()=>zt(e)));G=e,j=null;try{return tt(u,!0)}finally{j=r,G=l}}function Nt(n,i){i=i?Object.assign({},_t,i):_t;const r={value:n,observers:null,observerSlots:null,comparator:i.equals||void 0},l=s=>(typeof s=="function"&&(s=s(r.value)),pn(r,s));return[hn.bind(r),l]}function Ue(n,i,r){const l=Cr(n,i,!1,we);et(l)}function un(n,i,r){cn=li;const l=Cr(n,i,!1,we);(!r||!r.render)&&(l.user=!0),ue?ue.push(l):et(l)}function Or(n,i,r){r=r?Object.assign({},_t,r):_t;const l=Cr(n,i,!0,0);return l.observers=null,l.observerSlots=null,l.comparator=r.equals||void 0,et(l),hn.bind(l)}function ye(n){if(j===null)return n();const i=j;j=null;try{return n()}finally{j=i}}function oi(n){un(()=>ye(n))}function hn(){if(this.sources&&this.state)if(this.state===we)et(this);else{const n=z;z=null,tt(()=>Zt(this),!1),z=n}if(j){const n=this.observers?this.observers.length:0;j.sources?(j.sources.push(this),j.sourceSlots.push(n)):(j.sources=[this],j.sourceSlots=[n]),this.observers?(this.observers.push(j),this.observerSlots.push(j.sources.length-1)):(this.observers=[j],this.observerSlots=[j.sources.length-1])}return this.value}function pn(n,i,r){let l=n.value;return(!n.comparator||!n.comparator(l,i))&&(n.value=i,n.observers&&n.observers.length&&tt(()=>{for(let s=0;s<n.observers.length;s+=1){const f=n.observers[s],e=yr&&yr.running;e&&yr.disposed.has(f),(e?!f.tState:!f.state)&&(f.pure?z.push(f):ue.push(f),f.observers&&dn(f)),e||(f.state=we)}if(z.length>1e6)throw z=[],new Error},!1)),i}function et(n){if(!n.fn)return;zt(n);const i=Wt;si(n,n.value,i)}function si(n,i,r){let l;const s=G,f=j;j=G=n;try{l=n.fn(i)}catch(e){return n.pure&&(n.state=we,n.owned&&n.owned.forEach(zt),n.owned=null),n.updatedAt=r+1,gn(e)}finally{j=f,G=s}(!n.updatedAt||n.updatedAt<=r)&&(n.updatedAt!=null&&"observers"in n?pn(n,l):n.value=l,n.updatedAt=r)}function Cr(n,i,r,l=we,s){const f={fn:n,state:l,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:i,owner:G,context:G?G.context:null,pure:r};return G===null||G!==fn&&(G.owned?G.owned.push(f):G.owned=[f]),f}function Ut(n){if(n.state===0)return;if(n.state===Ft)return Zt(n);if(n.suspense&&ye(n.suspense.inFallback))return n.suspense.effects.push(n);const i=[n];for(;(n=n.owner)&&(!n.updatedAt||n.updatedAt<Wt);)n.state&&i.push(n);for(let r=i.length-1;r>=0;r--)if(n=i[r],n.state===we)et(n);else if(n.state===Ft){const l=z;z=null,tt(()=>Zt(n,i[0]),!1),z=l}}function tt(n,i){if(z)return n();let r=!1;i||(z=[]),ue?r=!0:ue=[],Wt++;try{const l=n();return ai(r),l}catch(l){r||(ue=null),z=null,gn(l)}}function ai(n){if(z&&(vn(z),z=null),n)return;const i=ue;ue=null,i.length&&tt(()=>cn(i),!1)}function vn(n){for(let i=0;i<n.length;i++)Ut(n[i])}function li(n){let i,r=0;for(i=0;i<n.length;i++){const l=n[i];l.user?n[r++]=l:Ut(l)}for(i=0;i<r;i++)Ut(n[i])}function Zt(n,i){n.state=0;for(let r=0;r<n.sources.length;r+=1){const l=n.sources[r];if(l.sources){const s=l.state;s===we?l!==i&&(!l.updatedAt||l.updatedAt<Wt)&&Ut(l):s===Ft&&Zt(l,i)}}}function dn(n){for(let i=0;i<n.observers.length;i+=1){const r=n.observers[i];r.state||(r.state=Ft,r.pure?z.push(r):ue.push(r),r.observers&&dn(r))}}function zt(n){let i;if(n.sources)for(;n.sources.length;){const r=n.sources.pop(),l=n.sourceSlots.pop(),s=r.observers;if(s&&s.length){const f=s.pop(),e=r.observerSlots.pop();l<s.length&&(f.sourceSlots[e]=l,s[l]=f,r.observerSlots[l]=e)}}if(n.owned){for(i=n.owned.length-1;i>=0;i--)zt(n.owned[i]);n.owned=null}if(n.cleanups){for(i=n.cleanups.length-1;i>=0;i--)n.cleanups[i]();n.cleanups=null}n.state=0}function ci(n){return n instanceof Error?n:new Error(typeof n=="string"?n:"Unknown error",{cause:n})}function gn(n,i=G){throw ci(n)}function Dt(n,i){return ye(()=>n(i||{}))}const fi=n=>`Stale read from <${n}>.`;function Br(n){const i=n.keyed,r=Or(()=>n.when,void 0,{equals:(l,s)=>i?l===s:!l==!s});return Or(()=>{const l=r();if(l){const s=n.children;return typeof s=="function"&&s.length>0?ye(()=>s(i?l:()=>{if(!ye(r))throw fi("Show");return n.when})):s}return n.fallback},void 0,void 0)}function ui(n,i,r){let l=r.length,s=i.length,f=l,e=0,u=0,p=i[s-1].nextSibling,v=null;for(;e<s||u<f;){if(i[e]===r[u]){e++,u++;continue}for(;i[s-1]===r[f-1];)s--,f--;if(s===e){const g=f<l?u?r[u-1].nextSibling:r[f-u]:p;for(;u<f;)n.insertBefore(r[u++],g)}else if(f===u)for(;e<s;)(!v||!v.has(i[e]))&&i[e].remove(),e++;else if(i[e]===r[f-1]&&r[u]===i[s-1]){const g=i[--s].nextSibling;n.insertBefore(r[u++],i[e++].nextSibling),n.insertBefore(r[--f],g),i[s]=r[f]}else{if(!v){v=new Map;let y=u;for(;y<f;)v.set(r[y],y++)}const g=v.get(i[e]);if(g!=null)if(u<g&&g<f){let y=e,E=1,b;for(;++y<s&&y<f&&!((b=v.get(i[y]))==null||b!==g+E);)E++;if(E>g-u){const C=i[e];for(;u<g;)n.insertBefore(r[u++],C)}else n.replaceChild(r[u++],i[e++])}else e++;else i[e++].remove()}}}const _r="_$DX_DELEGATE";function hi(n,i,r,l={}){let s;return ii(f=>{s=f,i===document?n():yn(i,n(),i.firstChild?null:void 0,r)},l.owner),()=>{s(),i.textContent=""}}function mn(n,i,r){let l;const s=()=>{const e=document.createElement("template");return e.innerHTML=n,r?e.content.firstChild.firstChild:e.content.firstChild},f=i?()=>ye(()=>document.importNode(l||(l=s()),!0)):()=>(l||(l=s())).cloneNode(!0);return f.cloneNode=f,f}function pi(n,i=window.document){const r=i[_r]||(i[_r]=new Set);for(let l=0,s=n.length;l<s;l++){const f=n[l];r.has(f)||(r.add(f),i.addEventListener(f,di))}}function Fr(n,i){i==null?n.removeAttribute("class"):n.className=i}function vi(n,i,r){return ye(()=>n(i,r))}function yn(n,i,r,l){if(r!==void 0&&!l&&(l=[]),typeof i!="function")return jt(n,i,l,r);Ue(s=>jt(n,i(),s,r),l)}function di(n){const i=`$$${n.type}`;let r=n.composedPath&&n.composedPath()[0]||n.target;for(n.target!==r&&Object.defineProperty(n,"target",{configurable:!0,value:r}),Object.defineProperty(n,"currentTarget",{configurable:!0,get(){return r||document}});r;){const l=r[i];if(l&&!r.disabled){const s=r[`${i}Data`];if(s!==void 0?l.call(r,s,n):l.call(r,n),n.cancelBubble)return}r=r._$host||r.parentNode||r.host}}function jt(n,i,r,l,s){for(;typeof r=="function";)r=r();if(i===r)return r;const f=typeof i,e=l!==void 0;if(n=e&&r[0]&&r[0].parentNode||n,f==="string"||f==="number")if(f==="number"&&(i=i.toString()),e){let u=r[0];u&&u.nodeType===3?u.data!==i&&(u.data=i):u=document.createTextNode(i),r=Be(n,r,l,u)}else r!==""&&typeof r=="string"?r=n.firstChild.data=i:r=n.textContent=i;else if(i==null||f==="boolean")r=Be(n,r,l);else{if(f==="function")return Ue(()=>{let u=i();for(;typeof u=="function";)u=u();r=jt(n,u,r,l)}),()=>r;if(Array.isArray(i)){const u=[],p=r&&Array.isArray(r);if(Sr(u,i,r,s))return Ue(()=>r=jt(n,u,r,l,!0)),()=>r;if(u.length===0){if(r=Be(n,r,l),e)return r}else p?r.length===0?Nr(n,u,l):ui(n,r,u):(r&&Be(n),Nr(n,u));r=u}else if(i.nodeType){if(Array.isArray(r)){if(e)return r=Be(n,r,l,i);Be(n,r,null,i)}else r==null||r===""||!n.firstChild?n.appendChild(i):n.replaceChild(i,n.firstChild);r=i}}return r}function Sr(n,i,r,l){let s=!1;for(let f=0,e=i.length;f<e;f++){let u=i[f],p=r&&r[n.length],v;if(!(u==null||u===!0||u===!1))if((v=typeof u)=="object"&&u.nodeType)n.push(u);else if(Array.isArray(u))s=Sr(n,u,p)||s;else if(v==="function")if(l){for(;typeof u=="function";)u=u();s=Sr(n,Array.isArray(u)?u:[u],Array.isArray(p)?p:[p])||s}else n.push(u),s=!0;else{const g=String(u);p&&p.nodeType===3&&p.data===g?n.push(p):n.push(document.createTextNode(g))}}return s}function Nr(n,i,r=null){for(let l=0,s=i.length;l<s;l++)n.insertBefore(i[l],r)}function Be(n,i,r,l){if(r===void 0)return n.textContent="";const s=l||document.createTextNode("");if(i.length){let f=!1;for(let e=i.length-1;e>=0;e--){const u=i[e];if(s!==u){const p=u.parentNode===n;!f&&!e?p?n.replaceChild(s,u):n.insertBefore(s,r):p&&u.remove()}else f=!0}}else n.insertBefore(s,r);return[s]}const gi="_page_1fsks_1",mi="_urlInput_1fsks_8",Ur={page:gi,urlInput:mi};var yi=mn('<div><h2>Welcome!</h2><p>Xschem Viewer is an online viewer for Xschem schematics, brought to your by <a href=https://tinytapeout.com target=_blank>Tiny Tapeout</a>.</p><h2>Load schematic from a URL</h2><p>Paste the URL of an XSchem schematic file to load it into the viewer:</p><div><input type=text id=uri-input placeholder="URL to load (e.g. https://github.com/owner/repo/blob/main/schematic.sch)"><button id=load-uri>Load</button></div><h3>Or choose an example:</h3><div class=examples><a href="?file=https://github.com/StefanSchippers/xschem_sky130/blob/main/sky130_tests/top.sch">Sky130 PDK');function wi(){const[n,i]=Nt(""),r=()=>{const l=new URL(window.location.href);l.searchParams.set("file",n()),window.location.href=l.toString()};return(()=>{var l=yi(),s=l.firstChild,f=s.nextSibling,e=f.nextSibling,u=e.nextSibling,p=u.nextSibling,v=p.firstChild,g=v.nextSibling;return v.$$keydown=y=>{y.key==="Enter"&&r()},v.$$input=y=>i(y.target.value),g.$$click=r,Ue(y=>{var E=Ur.page,b=Ur.urlInput;return E!==y.e&&Fr(l,y.e=E),b!==y.t&&Fr(p,y.t=b),y},{e:void 0,t:void 0}),Ue(()=>v.value=n()),l})()}pi(["input","keydown","click"]);function bi(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var qt={exports:{}};qt.exports=wn;qt.exports.addWheelListener=wn;qt.exports.removeWheelListener=xi;function wn(n,i,r){n.addEventListener("wheel",i,r)}function xi(n,i,r){n.removeEventListener("wheel",i,r)}var $i=qt.exports,Ht={exports:{}},Ai=4,Si=.001,Ci=1e-7,Ei=10,Qe=11,It=1/(Qe-1),Ti=typeof Float32Array=="function";function bn(n,i){return 1-3*i+3*n}function xn(n,i){return 3*i-6*n}function $n(n){return 3*n}function Vt(n,i,r){return((bn(i,r)*n+xn(i,r))*n+$n(i))*n}function An(n,i,r){return 3*bn(i,r)*n*n+2*xn(i,r)*n+$n(i)}function ki(n,i,r,l,s){var f,e,u=0;do e=i+(r-i)/2,f=Vt(e,l,s)-n,f>0?r=e:i=e;while(Math.abs(f)>Ci&&++u<Ei);return e}function Pi(n,i,r,l){for(var s=0;s<Ai;++s){var f=An(i,r,l);if(f===0)return i;var e=Vt(i,r,l)-n;i-=e/f}return i}function Li(n){return n}var Mi=function(i,r,l,s){if(!(0<=i&&i<=1&&0<=l&&l<=1))throw new Error("bezier x values must be in [0, 1] range");if(i===r&&l===s)return Li;for(var f=Ti?new Float32Array(Qe):new Array(Qe),e=0;e<Qe;++e)f[e]=Vt(e*It,i,l);function u(p){for(var v=0,g=1,y=Qe-1;g!==y&&f[g]<=p;++g)v+=It;--g;var E=(p-f[g])/(f[g+1]-f[g]),b=v+E*It,C=An(b,i,l);return C>=Si?Pi(p,b,i,l):C===0?b:ki(p,v,v+It,i,l)}return function(v){return v===0?0:v===1?1:Vt(u(v),r,s)}},Je=Mi,Zr={ease:Je(.25,.1,.25,1),easeIn:Je(.42,0,1,1),easeOut:Je(0,0,.58,1),easeInOut:Je(.42,0,.58,1),linear:Je(0,0,1,1)};Ht.exports=Ri;Ht.exports.makeAggregateRaf=Sn;Ht.exports.sharedScheduler=Sn();function Ri(n,i,r){var l=Object.create(null),s=Object.create(null);r=r||{};var f=typeof r.easing=="function"?r.easing:Zr[r.easing];f||(r.easing&&console.warn("Unknown easing function in amator: "+r.easing),f=Zr.ease);var e=typeof r.step=="function"?r.step:jr,u=typeof r.done=="function"?r.done:jr,p=Di(r.scheduler),v=Object.keys(i);v.forEach(function(M){l[M]=n[M],s[M]=i[M]-n[M]});var g=typeof r.duration=="number"?r.duration:400,y=Math.max(1,g*.06),E,b=0;return E=p.next(P),{cancel:C};function C(){p.cancel(E),E=0}function P(){var M=f(b/y);b+=1,B(M),b<=y?(E=p.next(P),e(n)):(E=0,setTimeout(function(){u(n)},0))}function B(M){v.forEach(function(U){n[U]=s[U]*M+l[U]})}}function jr(){}function Di(n){if(!n){var i=typeof window<"u"&&window.requestAnimationFrame;return i?Ii():Oi()}if(typeof n.next!="function")throw new Error("Scheduler is supposed to have next(cb) function");if(typeof n.cancel!="function")throw new Error("Scheduler is supposed to have cancel(handle) function");return n}function Ii(){return{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}}function Oi(){return{next:function(n){return setTimeout(n,1e3/60)},cancel:function(n){return clearTimeout(n)}}}function Sn(){var n=new Set,i=new Set,r=0;return{next:s,cancel:s,clearAll:l};function l(){n.clear(),i.clear(),cancelAnimationFrame(r),r=0}function s(u){i.add(u),f()}function f(){r||(r=requestAnimationFrame(e))}function e(){r=0;var u=i;i=n,n=u,n.forEach(function(p){p()}),n.clear()}}var Bi=Ht.exports,_i=function(i){Ni(i);var r=Fi(i);return i.on=r.on,i.off=r.off,i.fire=r.fire,i};function Fi(n){var i=Object.create(null);return{on:function(r,l,s){if(typeof l!="function")throw new Error("callback is expected to be a function");var f=i[r];return f||(f=i[r]=[]),f.push({callback:l,ctx:s}),n},off:function(r,l){var s=typeof r>"u";if(s)return i=Object.create(null),n;if(i[r]){var f=typeof l!="function";if(f)delete i[r];else for(var e=i[r],u=0;u<e.length;++u)e[u].callback===l&&e.splice(u,1)}return n},fire:function(r){var l=i[r];if(!l)return n;var s;arguments.length>1&&(s=Array.prototype.splice.call(arguments,1));for(var f=0;f<l.length;++f){var e=l[f];e.callback.apply(e.ctx,s)}return n}}}function Ni(n){if(!n)throw new Error("Eventify cannot use falsy object as events subject");for(var i=["on","fire","off"],r=0;r<i.length;++r)if(n.hasOwnProperty(i[r]))throw new Error("Subject cannot be eventified, since it already has property '"+i[r]+"'")}var Ui=Zi;function Zi(n,i,r){typeof r!="object"&&(r={});var l=typeof r.minVelocity=="number"?r.minVelocity:5,s=typeof r.amplitude=="number"?r.amplitude:.25,f=typeof r.cancelAnimationFrame=="function"?r.cancelAnimationFrame:ji(),e=typeof r.requestAnimationFrame=="function"?r.requestAnimationFrame:Vi(),u,p,v=342,g,y,E,b,C,P,B,M;return{start:N,stop:re,cancel:U};function U(){f(g),f(M)}function N(){u=n(),b=B=y=C=0,p=new Date,f(g),f(M),g=e(Y)}function Y(){var K=Date.now(),ee=K-p;p=K;var q=n(),H=q.x-u.x,se=q.y-u.y;u=q;var W=1e3/(1+ee);y=.8*H*W+.2*y,C=.8*se*W+.2*C,g=e(Y)}function re(){f(g),f(M);var K=n();E=K.x,P=K.y,p=Date.now(),(y<-l||y>l)&&(b=s*y,E+=b),(C<-l||C>l)&&(B=s*C,P+=B),M=e(ne)}function ne(){var K=Date.now()-p,ee=!1,q=0,H=0;b&&(q=-b*Math.exp(-K/v),q>.5||q<-.5?ee=!0:q=b=0),B&&(H=-B*Math.exp(-K/v),H>.5||H<-.5?ee=!0:H=B=0),ee&&(i(E+q,P+H),M=e(ne))}}function ji(){return typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearTimeout}function Vi(){return typeof requestAnimationFrame=="function"?requestAnimationFrame:function(n){return setTimeout(n,16)}}var Wi=zi;function zi(n){if(n)return{capture:Wr,release:Wr};var i,r,l,s=!1;return{capture:f,release:e};function f(u){s=!0,r=window.document.onselectstart,l=window.document.ondragstart,window.document.onselectstart=Vr,i=u,i.ondragstart=Vr}function e(){s&&(s=!1,window.document.onselectstart=r,i&&(i.ondragstart=l))}}function Vr(n){return n.stopPropagation(),!1}function Wr(){}var wr,zr;function qi(){if(zr)return wr;zr=1,wr=n;function n(){this.x=0,this.y=0,this.scale=1}return wr}var Ot={exports:{}},qr;function Hi(){if(qr)return Ot.exports;qr=1,Ot.exports=n,Ot.exports.canAttach=i;function n(r,l){if(!i(r))throw new Error("svg element is required for svg.panzoom to work");var s=r.ownerSVGElement;if(!s)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");l.disableKeyboardInteraction||s.setAttribute("tabindex",0);var f={getBBox:u,getScreenCTM:p,getOwner:e,applyTransform:g,initTransform:v};return f;function e(){return s}function u(){var y=r.getBBox();return{left:y.x,top:y.y,width:y.width,height:y.height}}function p(){var y=s.getCTM();return y||s.getScreenCTM()}function v(y){var E=r.getCTM();E===null&&(E=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),y.x=E.e,y.y=E.f,y.scale=E.a,s.removeAttributeNS(null,"viewBox")}function g(y){r.setAttribute("transform","matrix("+y.scale+" 0 0 "+y.scale+" "+y.x+" "+y.y+")")}}function i(r){return r&&r.ownerSVGElement&&r.getCTM}return Ot.exports}var Bt={exports:{}},Hr;function Gi(){if(Hr)return Bt.exports;Hr=1,Bt.exports=n,Bt.exports.canAttach=i;function n(r,l){var s=i(r);if(!s)throw new Error("panzoom requires DOM element to be attached to the DOM tree");var f=r.parentElement;r.scrollTop=0,l.disableKeyboardInteraction||f.setAttribute("tabindex",0);var e={getBBox:p,getOwner:u,applyTransform:v};return e;function u(){return f}function p(){return{left:0,top:0,width:r.clientWidth,height:r.clientHeight}}function v(g){r.style.transformOrigin="0 0 0",r.style.transform="matrix("+g.scale+", 0, 0, "+g.scale+", "+g.x+", "+g.y+")"}}function i(r){return r&&r.parentElement&&r.style}return Bt.exports}var Gr=$i,br=Bi,Yi=_i,Ki=Ui,Cn=Wi,Xi=Cn(),Ji=Cn(!0),Qi=qi(),Yr=Hi(),Kr=Gi(),eo=1,to=1.75,Xr=300,Jr=200,ro=En;function En(n,i){i=i||{};var r=i.controller;if(r||(Yr.canAttach(n)?r=Yr(n,i):Kr.canAttach(n)&&(r=Kr(n,i))),!r)throw new Error("Cannot create panzoom for the current type of dom element");var l=r.getOwner(),s={x:0,y:0},f=!1,e=new Qi;r.initTransform&&r.initTransform(e);var u=typeof i.filterKey=="function"?i.filterKey:Ne,p=typeof i.pinchSpeed=="number"?i.pinchSpeed:1,v=i.bounds,g=typeof i.maxZoom=="number"?i.maxZoom:Number.POSITIVE_INFINITY,y=typeof i.minZoom=="number"?i.minZoom:0,E=typeof i.boundsPadding=="number"?i.boundsPadding:.05,b=typeof i.zoomDoubleClickSpeed=="number"?i.zoomDoubleClickSpeed:to,C=i.beforeWheel||Ne,P=i.beforeMouseDown||Ne,B=typeof i.zoomSpeed=="number"?i.zoomSpeed:eo,M=Qr(i.transformOrigin),U=i.enableTextSelection?Ji:Xi;no(v),i.autocenter&&Yt();var N,Y=0,re=0,ne=0,K=null,ee=new Date,q,H=!1,se=!1,W,X,Ze,je,Ve,J;"smoothScroll"in i&&!i.smoothScroll?J=io():J=Ki(rr,or,i.smoothScroll);var We,he,be,xe=!1;ct();var $e={dispose:sr,moveBy:ve,moveTo:Ae,smoothMoveTo:ir,centerOn:nr,zoomTo:Re,zoomAbs:Pe,smoothZoom:Me,smoothZoomAbs:ur,showRectangle:Te,pause:pe,resume:rt,isPaused:Gt,getTransform:Kt,getMinZoom:Xt,setMinZoom:nt,getMaxZoom:it,setMaxZoom:ot,getTransformOrigin:Jt,setTransformOrigin:Qt,getZoomSpeed:er,setZoomSpeed:tr};Yi($e);var ze=typeof i.initialX=="number"?i.initialX:e.x,qe=typeof i.initialY=="number"?i.initialY:e.y,He=typeof i.initialZoom=="number"?i.initialZoom:e.scale;return(ze!=e.x||qe!=e.y||He!=e.scale)&&Pe(ze,qe,He),$e;function pe(){ft(),xe=!0}function rt(){xe&&(ct(),xe=!1)}function Gt(){return xe}function Te(h){var m=l.getBoundingClientRect(),w=Q(m.width,m.height),A=h.right-h.left,R=h.bottom-h.top;if(!Number.isFinite(A)||!Number.isFinite(R))throw new Error("Invalid rectangle");var I=w.x/A,O=w.y/R,V=Math.min(I,O);e.x=-(h.left+A/2)*V+w.x/2,e.y=-(h.top+R/2)*V+w.y/2,e.scale=V}function Q(h,m){if(r.getScreenCTM){var w=r.getScreenCTM(),A=w.a,R=w.d,I=w.e,O=w.f;s.x=h*A-I,s.y=m*R-O}else s.x=h,s.y=m;return s}function Yt(){var h,m,w=0,A=0,R=Ke();if(R)w=R.left,A=R.top,h=R.right-R.left,m=R.bottom-R.top;else{var I=l.getBoundingClientRect();h=I.width,m=I.height}var O=r.getBBox();if(!(O.width===0||O.height===0)){var V=m/O.height,ge=h/O.width,le=Math.min(ge,V);e.x=-(O.left+O.width/2)*le+h/2+w,e.y=-(O.top+O.height/2)*le+m/2+A,e.scale=le}}function Kt(){return e}function Xt(){return y}function nt(h){y=h}function it(){return g}function ot(h){g=h}function Jt(){return M}function Qt(h){M=Qr(h)}function er(){return B}function tr(h){if(!Number.isFinite(h))throw new Error("Zoom speed should be a number");B=h}function rr(){return{x:e.x,y:e.y}}function Ae(h,m){e.x=h,e.y=m,Ye(),de("pan"),ke()}function Ge(h,m){Ae(e.x+h,e.y+m)}function Ye(){var h=Ke();if(h){var m=!1,w=st(),A=h.left-w.right;return A>0&&(e.x+=A,m=!0),A=h.right-w.left,A<0&&(e.x+=A,m=!0),A=h.top-w.bottom,A>0&&(e.y+=A,m=!0),A=h.bottom-w.top,A<0&&(e.y+=A,m=!0),m}}function Ke(){if(v){if(typeof v=="boolean"){var h=l.getBoundingClientRect(),m=h.width,w=h.height;return{left:m*E,top:w*E,right:m*(1-E),bottom:w*(1-E)}}return v}}function st(){var h=r.getBBox(),m=at(h.left,h.top);return{left:m.x,top:m.y,right:h.width*e.scale+m.x,bottom:h.height*e.scale+m.y}}function at(h,m){return{x:h*e.scale+e.x,y:m*e.scale+e.y}}function ke(){f=!0,N=window.requestAnimationFrame(ar)}function lt(h,m,w){if(xr(h)||xr(m)||xr(w))throw new Error("zoom requires valid numbers");var A=e.scale*w;if(A<y){if(e.scale===y)return;w=y/e.scale}if(A>g){if(e.scale===g)return;w=g/e.scale}var R=Q(h,m);if(e.x=R.x-w*(R.x-e.x),e.y=R.y-w*(R.y-e.y),v&&E===1&&y===1)e.scale*=w,Ye();else{var I=Ye();I||(e.scale*=w)}de("zoom"),ke()}function Pe(h,m,w){var A=w/e.scale;lt(h,m,A)}function nr(h){var m=h.ownerSVGElement;if(!m)throw new Error("ui element is required to be within the scene");var w=h.getBoundingClientRect(),A=w.left+w.width/2,R=w.top+w.height/2,I=m.getBoundingClientRect(),O=I.width/2-A,V=I.height/2-R;ve(O,V,!0)}function ir(h,m){ve(h-e.x,m-e.y,!0)}function ve(h,m,w){if(!w)return Ge(h,m);We&&We.cancel();var A={x:0,y:0},R={x:h,y:m},I=0,O=0;We=br(A,R,{step:function(V){Ge(V.x-I,V.y-O),I=V.x,O=V.y}})}function or(h,m){De(),Ae(h,m)}function sr(){ft()}function ct(){l.addEventListener("mousedown",wt,{passive:!1}),l.addEventListener("dblclick",yt,{passive:!1}),l.addEventListener("touchstart",ae,{passive:!1}),l.addEventListener("keydown",ut,{passive:!1}),Gr.addWheelListener(l,St,{passive:!1}),ke()}function ft(){Gr.removeWheelListener(l,St),l.removeEventListener("mousedown",wt),l.removeEventListener("keydown",ut),l.removeEventListener("dblclick",yt),l.removeEventListener("touchstart",ae),N&&(window.cancelAnimationFrame(N),N=0),J.cancel(),$t(),At(),U.release(),Xe()}function ar(){f&&lr()}function lr(){f=!1,r.applyTransform(e),de("transform"),N=0}function ut(h){var m=0,w=0,A=0;if(h.keyCode===38?w=1:h.keyCode===40?w=-1:h.keyCode===37?m=1:h.keyCode===39?m=-1:h.keyCode===189||h.keyCode===109?A=1:(h.keyCode===187||h.keyCode===107)&&(A=-1),!u(h,m,w,A)){if(m||w){h.preventDefault(),h.stopPropagation();var R=l.getBoundingClientRect(),I=Math.min(R.width,R.height),O=.05,V=I*O*m,ge=I*O*w;ve(V,ge)}if(A){var le=Ct(A*100),I=M?Ce():ht();Re(I.x,I.y,le)}}}function ht(){var h=l.getBoundingClientRect();return{x:h.width/2,y:h.height/2}}function ae(h){if(cr(h),Se(),h.touches.length===1)return fr(h,h.touches[0]);h.touches.length===2&&(Ve=mt(h.touches[0],h.touches[1]),be=!0,vt())}function cr(h){i.onTouch&&!i.onTouch(h)||(h.stopPropagation(),h.preventDefault())}function pt(h){Se(),!(i.onDoubleClick&&!i.onDoubleClick(h))&&(h.preventDefault(),h.stopPropagation())}function fr(h){re=new Date;var m=h.touches[0],w=te(m);q=w;var A=Q(w.x,w.y);W=A.x,X=A.y,Ze=W,je=X,J.cancel(),vt()}function vt(){H||(H=!0,document.addEventListener("touchmove",dt),document.addEventListener("touchend",Le),document.addEventListener("touchcancel",Le))}function dt(h){if(h.touches.length===1){h.stopPropagation();var m=h.touches[0],w=te(m),A=Q(w.x,w.y),R=A.x-W,I=A.y-X;R!==0&&I!==0&&Et(),W=A.x,X=A.y,ve(R,I)}else if(h.touches.length===2){be=!0;var O=h.touches[0],V=h.touches[1],ge=mt(O,V),le=1+(ge/Ve-1)*p,Tt=te(O),kt=te(V);if(W=(Tt.x+kt.x)/2,X=(Tt.y+kt.y)/2,M){var w=Ce();W=w.x,X=w.y}Re(W,X,le),Ve=ge,h.stopPropagation(),h.preventDefault()}}function Se(){ne&&(clearTimeout(ne),ne=0)}function gt(h){if(i.onClick){Se();var m=W-Ze,w=X-je,A=Math.sqrt(m*m+w*w);A>5||(ne=setTimeout(function(){ne=0,i.onClick(h)},Xr))}}function Le(h){if(Se(),h.touches.length>0){var m=te(h.touches[0]),w=Q(m.x,m.y);W=w.x,X=w.y}else{var A=new Date;if(A-Y<Xr)if(M){var m=Ce();Me(m.x,m.y,b)}else Me(q.x,q.y,b);else A-re<Jr&&gt(h);Y=A,Xe(),At()}}function mt(h,m){var w=h.clientX-m.clientX,A=h.clientY-m.clientY;return Math.sqrt(w*w+A*A)}function yt(h){pt(h);var m=te(h);M&&(m=Ce()),Me(m.x,m.y,b)}function wt(h){if(Se(),!P(h)){if(K=h,ee=new Date,H)return h.stopPropagation(),!1;var m=h.button===1&&window.event!==null||h.button===0;if(m){J.cancel();var w=te(h),A=Q(w.x,w.y);return Ze=W=A.x,je=X=A.y,document.addEventListener("mousemove",bt),document.addEventListener("mouseup",xt),U.capture(h.target||h.srcElement),!1}}}function bt(h){if(!H){Et();var m=te(h),w=Q(m.x,m.y),A=w.x-W,R=w.y-X;W=w.x,X=w.y,ve(A,R)}}function xt(){var h=new Date;h-ee<Jr&&gt(K),U.release(),Xe(),$t()}function $t(){document.removeEventListener("mousemove",bt),document.removeEventListener("mouseup",xt),se=!1}function At(){document.removeEventListener("touchmove",dt),document.removeEventListener("touchend",Le),document.removeEventListener("touchcancel",Le),se=!1,be=!1,H=!1}function St(h){if(!C(h)){J.cancel();var m=h.deltaY;h.deltaMode>0&&(m*=100);var w=Ct(m);if(w!==1){var A=M?Ce():te(h);Re(A.x,A.y,w),h.preventDefault()}}}function te(h){var m,w,A=l.getBoundingClientRect();return m=h.clientX-A.left,w=h.clientY-A.top,{x:m,y:w}}function Me(h,m,w){var A=e.scale,R={scale:A},I={scale:w*A};J.cancel(),De(),he=br(R,I,{step:function(O){Pe(h,m,O.scale)},done:hr})}function ur(h,m,w){var A=e.scale,R={scale:A},I={scale:w};J.cancel(),De(),he=br(R,I,{step:function(O){Pe(h,m,O.scale)}})}function Ce(){var h=l.getBoundingClientRect();return{x:h.width*M.x,y:h.height*M.y}}function Re(h,m,w){return J.cancel(),De(),lt(h,m,w)}function De(){he&&(he.cancel(),he=null)}function Ct(h){var m=Math.sign(h),w=Math.min(.25,Math.abs(B*h/128));return 1-m*w}function Et(){se||(de("panstart"),se=!0,J.start())}function Xe(){se&&(be||J.stop(),de("panend"))}function hr(){de("zoomend")}function de(h){$e.fire(h,$e)}}function Qr(n){if(n){if(typeof n=="object")return(!_e(n.x)||!_e(n.y))&&en(n),n;en()}}function en(n){throw console.error(n),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join(`
`))}function Ne(){}function no(n){var i=typeof n;if(!(i==="undefined"||i==="boolean")){var r=_e(n.left)&&_e(n.top)&&_e(n.bottom)&&_e(n.right);if(!r)throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}}function _e(n){return Number.isFinite(n)}function xr(n){return Number.isNaN?Number.isNaN(n):n!==n}function io(){return{start:Ne,stop:Ne,cancel:Ne}}function oo(){if(typeof document>"u")return;var n=document.getElementsByTagName("script");if(!n)return;for(var i,r=0;r<n.length;++r){var l=n[r];if(l.src&&l.src.match(/\bpanzoom(\.min)?\.js/)){i=l;break}}if(!i)return;var s=i.getAttribute("query");if(!s)return;var f=i.getAttribute("name")||"pz",e=Date.now();u();function u(){var g=document.querySelector(s);if(!g){var y=Date.now(),E=y-e;if(E<2e3){setTimeout(u,100);return}console.error("Cannot find the panzoom element",f);return}var b=p(i);console.log(b),window[f]=En(g,b)}function p(g){for(var y=g.attributes,E={},b=0;b<y.length;++b){var C=y[b],P=v(C);P&&(E[P.name]=P.value)}return E}function v(g){if(g.name){var y=g.name[0]==="p"&&g.name[1]==="z"&&g.name[2]==="-";if(y){var E=g.name.substr(3),b=JSON.parse(g.value);return{name:E,value:b}}}}}oo();const so=bi(ro);function tn(n){const i=new URL(n);if(i.hostname!=="github.com")return n;i.hostname="raw.githubusercontent.com";const r=i.pathname.substring(1).split("/");return r[2]==="blob"&&(r.splice(2,1),i.pathname=r.join("/")),i.toString()}class ao{constructor(i){oe(this,"cache",new Map);oe(this,"pathToUrl",new Map);oe(this,"baseURL");this.libraries=i}async fileExists(i){try{return await this.load(i),!0}catch{return!1}}async load(i){const r=this.cache.get(i);if(r!=null)return r;const l=await this.fetchContent(i);if(!l.ok)throw new Error(`File not found: ${i}`);const s=await l.text();return this.cache.set(i,s),s}async fetchContent(i){if(i.toLowerCase().startsWith("https://")){const r=tn(i);return await fetch(r)}for(const r of this.libraries)if(i.startsWith(r.path)){const l=r.url+i;return await fetch(l)}if(this.baseURL!=null){const r=new URL(i,tn(this.baseURL)),l=await fetch(r);if(l.ok)return this.pathToUrl.set(i,r.toString()),l;const s=r.pathname.split("/").slice(0,4).join("/")+"/"+i;if(r.hostname==="raw.githubusercontent.com"&&r.pathname!==s){r.pathname=s;const f=await fetch(r);if(f.ok)return this.pathToUrl.set(i,r.toString()),f}}if(!i.includes("/"))return await this.fetchContent(`devices/${i}`);throw new Error(`File not found: ${i}`)}}const $r=new ao([{path:"devices/",url:"https://raw.githubusercontent.com/StefanSchippers/xschem/master/xschem_library/"},{path:"stdcells/",url:"https://raw.githubusercontent.com/StefanSchippers/xschem_sky130/main/"},{path:"sky130_tests/",url:"https://raw.githubusercontent.com/StefanSchippers/xschem_sky130/main/"},{path:"sky130_fd_pr/",url:"https://raw.githubusercontent.com/StefanSchippers/xschem_sky130/main/"},{path:"sky130_stdcells/",url:"https://raw.githubusercontent.com/StefanSchippers/xschem_sky130/main/"},{path:"mips_cpu/",url:"https://raw.githubusercontent.com/StefanSchippers/xschem_sky130/main/"},{path:"sg13g2_pr",url:"https://raw.githubusercontent.com/IHP-GmbH/IHP-Open-PDK/main/ihp-sg13g2/libs.tech/xschem/"},{path:"sg13g2_stdcells",url:"https://raw.githubusercontent.com/IHP-GmbH/IHP-Open-PDK/main/ihp-sg13g2/libs.tech/xschem/"},{path:"sg13g2_test",url:"https://raw.githubusercontent.com/IHP-GmbH/IHP-Open-PDK/main/ihp-sg13g2/libs.tech/xschem/"}]);var Fe=(n=>(n[n.Background=0]="Background",n[n.Wire=1]="Wire",n[n.Grid=2]="Grid",n[n.Text=3]="Text",n[n.Symbol=4]="Symbol",n[n.Pin=5]="Pin",n))(Fe||{});const lo="modulepreload",co=function(n){return"/"+n},rn={},fo=function(i,r,l){let s=Promise.resolve();if(r&&r.length>0){const e=document.getElementsByTagName("link"),u=document.querySelector("meta[property=csp-nonce]"),p=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));s=Promise.allSettled(r.map(v=>{if(v=co(v),v in rn)return;rn[v]=!0;const g=v.endsWith(".css"),y=g?'[rel="stylesheet"]':"";if(!!l)for(let C=e.length-1;C>=0;C--){const P=e[C];if(P.href===v&&(!g||P.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${v}"]${y}`))return;const b=document.createElement("link");if(b.rel=g?"stylesheet":lo,g||(b.as="script"),b.crossOrigin="",b.href=v,p&&b.setAttribute("nonce",p),document.head.appendChild(b),g)return new Promise((C,P)=>{b.addEventListener("load",C),b.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${v}`)))})}))}function f(e){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=e,window.dispatchEvent(u),!u.defaultPrevented)throw e}return s.then(e=>{for(const u of e||[])u.status==="rejected"&&f(u.reason);return i().catch(f)})},uo=`# SPDX-License-Identifier: Apache-2.0
# Copyright 2024 Tiny Tapeout LTD
# Author: Uri Shaked

proc ev {args} {
  return [format %.4g [expr [join $args]]]
}
`;let Ar=null;async function ho(){const{wacl:n}=await fo(async()=>{const{wacl:r}=await import("./wacl-Dpvn6MBD.js");return{wacl:r}},[]),i=await new Promise(r=>n.onReady(r));return i.Eval(uo),i}async function po(n){return Ar==null&&(Ar=ho()),(await Ar).Eval(n)}class vo{constructor(){oe(this,"_listeners",new Set)}listen(i){return this._listeners.add(i),i}unlisten(i){this._listeners.delete(i)}get listeners(){return this._listeners}}class nn{constructor(){oe(this,"_event",new vo)}fire(i){for(const r of this._event.listeners)r(i)}get event(){return this._event}}function on(n,i){return n.x===i.x1&&n.y===i.y1||n.x===i.x2&&n.y===i.y2?!1:go(n,i.x1,i.y1,i.x2,i.y2)<.01}function go(n,i,r,l,s){const f=n.x-i,e=n.y-r,u=l-i,p=s-r,v=f*u+e*p,g=u*u+p*p;let y=-1;g!==0&&(y=v/g);let E,b;y<0?(E=i,b=r):y>1?(E=l,b=s):(E=i+y*u,b=r+y*p);const C=n.x-E,P=n.y-b;return Math.sqrt(C*C+P*P)}const Tn=function(){function n(s,f){function e(){this.constructor=s}e.prototype=f.prototype,s.prototype=new e}function i(s,f,e,u){var p=Error.call(this,s);return Object.setPrototypeOf&&Object.setPrototypeOf(p,i.prototype),p.expected=f,p.found=e,p.location=u,p.name="SyntaxError",p}n(i,Error);function r(s,f,e){return e=e||" ",s.length>f?s:(f-=s.length,e+=e.repeat(f),s+e.slice(0,f))}i.prototype.format=function(s){var f="Error: "+this.message;if(this.location){var e=null,u;for(u=0;u<s.length;u++)if(s[u].source===this.location.source){e=s[u].text.split(/\r\n|\n|\r/g);break}var p=this.location.start,v=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(p):p,g=this.location.source+":"+v.line+":"+v.column;if(e){var y=this.location.end,E=r("",v.line.toString().length," "),b=e[p.line-1],C=p.line===y.line?y.column:b.length+1,P=C-p.column||1;f+=`
 --> `+g+`
`+E+` |
`+v.line+" | "+b+`
`+E+" | "+r("",p.column-1," ")+r("",P,"^")}else f+=`
 at `+g}return f},i.buildMessage=function(s,f){var e={literal:function(b){return'"'+p(b.text)+'"'},class:function(b){var C=b.parts.map(function(P){return Array.isArray(P)?v(P[0])+"-"+v(P[1]):v(P)});return"["+(b.inverted?"^":"")+C.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(b){return b.description}};function u(b){return b.charCodeAt(0).toString(16).toUpperCase()}function p(b){return b.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(C){return"\\x0"+u(C)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(C){return"\\x"+u(C)})}function v(b){return b.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(C){return"\\x0"+u(C)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(C){return"\\x"+u(C)})}function g(b){return e[b.type](b)}function y(b){var C=b.map(g),P,B;if(C.sort(),C.length>0){for(P=1,B=1;P<C.length;P++)C[P-1]!==C[P]&&(C[B]=C[P],B++);C.length=B}switch(C.length){case 1:return C[0];case 2:return C[0]+" or "+C[1];default:return C.slice(0,-1).join(", ")+", or "+C[C.length-1]}}function E(b){return b?'"'+p(b)+'"':"end of input"}return"Expected "+y(s)+" but "+E(f)+" found."};function l(s,f){f=f!==void 0?f:{};var e={},u=f.grammarSource,p={Start:vr},v=vr,g="v",y="{",E="}",b="xschem",C="version=",P="file_version=",B="S",M="V",U="G",N="E",Y="K",re="\\",ne="=",K='"',ee='\\\\"',q="L",H="B",se="P",W="A",X="T",Ze="N",je="C",Ve="[",J="]",We=".",he=/^[0-9.]/,be=/^[A-Z0-9]/,xe=/^[^}]/,$e=/^[^\\{}]/,ze=/^[^ \r\n\t;"\\=}]/,qe=/^[^ \r\n\t{}]/,He=/^[^\\"]/,pe=/^[0-9]/,rt=/^[ \t\n\r]/,Gt=F("v",!1),Te=F("{",!1),Q=F("}",!1),Yt=F("xschem",!1),Kt=F("version=",!1),Xt=F("file_version=",!1),nt=ce([["0","9"],"."],!1,!1),it=ce([["A","Z"],["0","9"]],!1,!1),ot=ce(["}"],!0,!1),Jt=F("S",!1),Qt=F("V",!1),er=F("G",!1),tr=F("E",!1),rr=F("K",!1),Ae=F("\\",!1),Ge=ce(["\\","{","}"],!0,!1),Ye=F("=",!1),Ke=ce([" ","\r",`
`,"	",";",'"',"\\","=","}"],!0,!1),st=ce([" ","\r",`
`,"	","{","}"],!0,!1),at=F('"',!1),ke=ce(["\\",'"'],!0,!1),lt=F('\\\\"',!1),Pe=Pn(),nr=F("L",!1),ir=F("B",!1),ve=Mn("polygon"),or=F("P",!1),sr=F("A",!1),ct=F("T",!1),ft=F("N",!1),ar=F("C",!1),lr=F("[",!1),ut=F("]",!1),ht=F("-",!1),ae=ce([["0","9"]],!1,!1),cr=F(".",!1),pt=ce([" ","	",`
`,"\r"],!1,!1),fr=function(t,a){return[...t?[t]:[],...a]},vt=function(t,a){return{type:"Version",...t,license:a}},dt=function(t,a){return{version:t,fileVersion:a}},Se=function(t){return Ie()},gt=function(t){return t.join("")},Le=function(t){return t},mt=function(t){return{type:"Spice",content:t}},yt=function(t){return{type:"Verilog",content:t}},wt=function(t){return{type:"VHDL",content:t}},bt=function(t){return{type:"TEDAx",content:t}},xt=function(t){return{type:"GlobalProperties",properties:t}},$t=function(t){return t.join("")},At=function(t){return t},St=function(){return Ie()},te=function(t){return Object.fromEntries(t?[t[0]].concat(t[1].map(a=>a[1])):[])},Me=function(t,a){return[t,a]},ur=function(t){return[]},Ce=function(){return Ie()},Re=function(t){return t.replace(/\\./g,a=>a[1])},De=function(t){return t.join("")},Ct=function(t){return t.join("")},Et=function(){return Ie()},Xe=function(){return'\\"'},hr=function(t){return t},de=function(t,a,c,d,$,x){return{type:"Line",layer:t,x1:a,y1:c,x2:d,y2:$,properties:x}},h=function(t,a,c,d,$,x){return{type:"Rectangle",layer:t,x1:a,y1:c,x2:d,y2:$,properties:x}},m=function(t,a,c,d){return{type:"Polygon",layer:t,points:c,properties:d}},w=function(t,a){return[t].concat(a.map(c=>c[1]))},A=function(t,a){return{x:t,y:a}},R=function(t,a,c,d,$,x,D){return{type:"Arc",layer:t,centerX:a,centerY:c,radius:d,startAngle:$,sweepAngle:x,properties:D}},I=function(t,a,c,d,$,x,D,_){return{type:"Text",text:t,x:a,y:c,rotation:d,mirror:$,hSize:x,vSize:D,properties:_}},O=function(t,a,c,d,$){return{type:"Wire",x1:t,y1:a,x2:c,y2:d,properties:$}},V=function(t,a,c,d,$,x){return{type:"Component",symbolReference:t,x:a,y:c,rotation:d,flip:$,properties:x}},ge=function(t){return{type:"EmbeddedSymbol",symbol:t}},le=function(t){return parseFloat(t)},Tt=function(t){return parseFloat(t)},kt=function(){return parseFloat(Ie())},kn=function(){return parseInt(Ie(),10)},o=0,L=0,Pt=[{line:1,column:1}],ie=0,pr=[],T=0,Lt;if("startRule"in f){if(!(f.startRule in p))throw new Error(`Can't start parsing from rule "`+f.startRule+'".');v=p[f.startRule]}function Ie(){return s.substring(L,o)}function F(t,a){return{type:"literal",text:t,ignoreCase:a}}function ce(t,a,c){return{type:"class",parts:t,inverted:a,ignoreCase:c}}function Pn(){return{type:"any"}}function Ln(){return{type:"end"}}function Mn(t){return{type:"other",description:t}}function Er(t){var a=Pt[t],c;if(a)return a;for(c=t-1;!Pt[c];)c--;for(a=Pt[c],a={line:a.line,column:a.column};c<t;)s.charCodeAt(c)===10?(a.line++,a.column=1):a.column++,c++;return Pt[t]=a,a}function Tr(t,a,c){var d=Er(t),$=Er(a),x={source:u,start:{offset:t,line:d.line,column:d.column},end:{offset:a,line:$.line,column:$.column}};return c&&u&&typeof u.offset=="function"&&(x.start=u.offset(x.start),x.end=u.offset(x.end)),x}function k(t){o<ie||(o>ie&&(ie=o,pr=[]),pr.push(t))}function Rn(t,a,c){return new i(i.buildMessage(t,a),t,a,c)}function vr(){var t,a,c,d;for(t=o,S(),a=Dn(),a===e&&(a=null),S(),c=[],d=Pr();d!==e;)c.push(d),d=Pr();return L=t,t=fr(a,c),t}function Dn(){var t,a,c,d,$,x;return t=o,s.charCodeAt(o)===118?(a=g,o++):(a=e,T===0&&k(Gt)),a!==e?(S(),s.charCodeAt(o)===123?(c=y,o++):(c=e,T===0&&k(Te)),c!==e?(S(),d=In(),d!==e?(S(),$=On(),S(),s.charCodeAt(o)===125?(x=E,o++):(x=e,T===0&&k(Q)),x!==e?(L=t,t=vt(d,$)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e),t}function In(){var t,a,c,d,$,x;return t=o,s.substr(o,6)===b?(a=b,o+=6):(a=e,T===0&&k(Yt)),a!==e?(S(),s.substr(o,8)===C?(c=C,o+=8):(c=e,T===0&&k(Kt)),c!==e?(d=kr(),d!==e?(S(),s.substr(o,13)===P?($=P,o+=13):($=e,T===0&&k(Xt)),$!==e?(x=kr(),x!==e?(L=t,t=dt(d,x)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e),t}function kr(){var t,a,c,d;if(t=o,a=[],he.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(nt)),c!==e)for(;c!==e;)a.push(c),he.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(nt));else a=e;if(a!==e){for(c=[],be.test(s.charAt(o))?(d=s.charAt(o),o++):(d=e,T===0&&k(it));d!==e;)c.push(d),be.test(s.charAt(o))?(d=s.charAt(o),o++):(d=e,T===0&&k(it));L=t,t=Se()}else o=t,t=e;return t}function On(){var t,a,c;for(t=o,a=[],xe.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(ot));c!==e;)a.push(c),xe.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(ot));return L=t,a=gt(a),t=a,t}function Pr(){var t,a;return t=o,a=Bn(),a!==e?(S(),L=t,t=Le(a)):(o=t,t=e),t}function Bn(){var t;return t=zn(),t===e&&(t=qn(),t===e&&(t=Yn(),t===e&&(t=Kn(),t===e&&(t=Hn(),t===e&&(t=Xn(),t===e&&(t=Jn(),t===e&&(t=_n(),t===e&&(t=Fn(),t===e&&(t=Nn(),t===e&&(t=Un(),t===e&&(t=Zn(),t===e&&(t=Qn())))))))))))),t}function _n(){var t,a,c;return t=o,s.charCodeAt(o)===83?(a=B,o++):(a=e,T===0&&k(Jt)),a!==e?(S(),c=Oe(),c!==e?(L=t,t=mt(c)):(o=t,t=e)):(o=t,t=e),t}function Fn(){var t,a,c;return t=o,s.charCodeAt(o)===86?(a=M,o++):(a=e,T===0&&k(Qt)),a!==e?(S(),c=Oe(),c!==e?(L=t,t=yt(c)):(o=t,t=e)):(o=t,t=e),t}function Nn(){var t,a,c;return t=o,s.charCodeAt(o)===71?(a=U,o++):(a=e,T===0&&k(er)),a!==e?(S(),c=Oe(),c!==e?(L=t,t=wt(c)):(o=t,t=e)):(o=t,t=e),t}function Un(){var t,a,c;return t=o,s.charCodeAt(o)===69?(a=N,o++):(a=e,T===0&&k(tr)),a!==e?(S(),c=Oe(),c!==e?(L=t,t=bt(c)):(o=t,t=e)):(o=t,t=e),t}function Zn(){var t,a,c;return t=o,s.charCodeAt(o)===75?(a=Y,o++):(a=e,T===0&&k(rr)),a!==e?(S(),c=me(),c!==e?(L=t,t=xt(c)):(o=t,t=e)):(o=t,t=e),t}function Oe(){var t,a,c,d;if(t=o,s.charCodeAt(o)===123?(a=y,o++):(a=e,T===0&&k(Te)),a!==e){for(S(),c=[],d=Mt(),d===e&&(d=Lr());d!==e;)c.push(d),d=Mt(),d===e&&(d=Lr());s.charCodeAt(o)===125?(d=E,o++):(d=e,T===0&&k(Q)),d!==e?(L=t,t=$t(c)):(o=t,t=e)}else o=t,t=e;return t}function Mt(){var t,a,c;return t=o,s.charCodeAt(o)===92?(a=re,o++):(a=e,T===0&&k(Ae)),a!==e?(s.charCodeAt(o)===92?(c=re,o++):(c=e,T===0&&k(Ae)),c===e&&(s.charCodeAt(o)===123?(c=y,o++):(c=e,T===0&&k(Te)),c===e&&(s.charCodeAt(o)===125?(c=E,o++):(c=e,T===0&&k(Q)))),c!==e?(L=t,t=At(c)):(o=t,t=e)):(o=t,t=e),t}function Lr(){var t,a,c;if(t=o,a=[],$e.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(Ge)),c!==e)for(;c!==e;)a.push(c),$e.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(Ge));else a=e;return a!==e&&(L=t,a=St()),t=a,t}function me(){var t,a,c,d,$,x,D,_;if(t=o,s.charCodeAt(o)===123?(a=y,o++):(a=e,T===0&&k(Te)),a!==e){if(S(),c=o,d=dr(),d!==e){for($=[],x=o,D=S(),_=dr(),_!==e?(D=[D,_],x=D):(o=x,x=e);x!==e;)$.push(x),x=o,D=S(),_=dr(),_!==e?(D=[D,_],x=D):(o=x,x=e);d=[d,$],c=d}else o=c,c=e;c===e&&(c=null),d=S(),s.charCodeAt(o)===125?($=E,o++):($=e,T===0&&k(Q)),$!==e?(L=t,t=te(c)):(o=t,t=e)}else o=t,t=e;return t}function dr(){var t,a,c,d;return t=o,a=Mr(),a!==e?(S(),s.charCodeAt(o)===61?(c=ne,o++):(c=e,T===0&&k(Ye)),c!==e?(S(),d=jn(),d!==e?(L=t,t=Me(a,d)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e),t===e&&(t=o,a=Mr(),a!==e&&(L=t,a=ur()),t=a),t}function Mr(){var t,a,c;if(t=o,a=[],ze.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(Ke)),c!==e)for(;c!==e;)a.push(c),ze.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(Ke));else a=e;return a!==e&&(L=t,a=Ce()),t=a,t}function jn(){var t,a;return t=o,a=Wn(),a!==e&&(L=t,a=Re(a)),t=a,t===e&&(t=Vn()),t}function Vn(){var t,a,c;if(t=o,a=[],c=Mt(),c===e&&(qe.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(st))),c!==e)for(;c!==e;)a.push(c),c=Mt(),c===e&&(qe.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(st)));else a=e;return a!==e&&(L=t,a=De(a)),t=a,t}function Wn(){var t,a,c,d;if(t=o,s.charCodeAt(o)===34?(a=K,o++):(a=e,T===0&&k(at)),a!==e){for(c=[],d=Dr(),d===e&&(d=Rr());d!==e;)c.push(d),d=Dr(),d===e&&(d=Rr());s.charCodeAt(o)===34?(d=K,o++):(d=e,T===0&&k(at)),d!==e?(L=t,t=Ct(c)):(o=t,t=e)}else o=t,t=e;return t}function Rr(){var t,a,c;if(t=o,a=[],He.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(ke)),c!==e)for(;c!==e;)a.push(c),He.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(ke));else a=e;return a!==e&&(L=t,a=Et()),t=a,t}function Dr(){var t,a,c;return t=o,s.substr(o,3)===ee?(a=ee,o+=3):(a=e,T===0&&k(lt)),a!==e&&(L=t,a=Xe()),t=a,t===e&&(t=o,s.charCodeAt(o)===92?(a=re,o++):(a=e,T===0&&k(Ae)),a!==e?(s.length>o?(c=s.charAt(o),o++):(c=e,T===0&&k(Pe)),c!==e?(L=t,t=hr(c)):(o=t,t=e)):(o=t,t=e)),t}function zn(){var t,a,c,d,$,x,D,_;return t=o,s.charCodeAt(o)===76?(a=q,o++):(a=e,T===0&&k(nr)),a!==e?(S(),c=fe(),c!==e?(S(),d=Z(),d!==e?(S(),$=Z(),$!==e?(S(),x=Z(),x!==e?(S(),D=Z(),D!==e?(S(),_=me(),_!==e?(L=t,t=de(c,d,$,x,D,_)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e),t}function qn(){var t,a,c,d,$,x,D,_;return t=o,s.charCodeAt(o)===66?(a=H,o++):(a=e,T===0&&k(ir)),a!==e?(S(),c=fe(),c!==e?(S(),d=Z(),d!==e?(S(),$=Z(),$!==e?(S(),x=Z(),x!==e?(S(),D=Z(),D!==e?(S(),_=me(),_!==e?(L=t,t=h(c,d,$,x,D,_)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e),t}function Hn(){var t,a,c,d,$,x;return T++,t=o,s.charCodeAt(o)===80?(a=se,o++):(a=e,T===0&&k(or)),a!==e?(S(),c=fe(),c!==e?(S(),d=fe(),d!==e?(S(),$=Gn(),$!==e?(S(),x=me(),x!==e?(L=t,t=m(c,d,$,x)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e),T--,t===e&&(a=e,T===0&&k(ve)),t}function Gn(){var t,a,c,d,$,x;if(t=o,a=gr(),a!==e){for(c=[],d=o,$=S(),x=gr(),x!==e?($=[$,x],d=$):(o=d,d=e);d!==e;)c.push(d),d=o,$=S(),x=gr(),x!==e?($=[$,x],d=$):(o=d,d=e);L=t,t=w(a,c)}else o=t,t=e;return t}function gr(){var t,a,c;return t=o,a=Z(),a!==e?(S(),c=Z(),c!==e?(L=t,t=A(a,c)):(o=t,t=e)):(o=t,t=e),t}function Yn(){var t,a,c,d,$,x,D,_,Ee;return t=o,s.charCodeAt(o)===65?(a=W,o++):(a=e,T===0&&k(sr)),a!==e?(S(),c=fe(),c!==e?(S(),d=Z(),d!==e?(S(),$=Z(),$!==e?(S(),x=Z(),x!==e?(S(),D=Ir(),D!==e?(S(),_=Ir(),_!==e?(S(),Ee=me(),Ee!==e?(L=t,t=R(c,d,$,x,D,_,Ee)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e),t}function Kn(){var t,a,c,d,$,x,D,_,Ee,mr;return t=o,s.charCodeAt(o)===84?(a=X,o++):(a=e,T===0&&k(ct)),a!==e?(S(),c=Oe(),c!==e?(S(),d=Z(),d!==e?(S(),$=Z(),$!==e?(S(),x=fe(),x!==e?(S(),D=fe(),D!==e?(S(),_=Rt(),_!==e?(S(),Ee=Rt(),Ee!==e?(S(),mr=me(),mr!==e?(L=t,t=I(c,d,$,x,D,_,Ee,mr)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e),t}function Xn(){var t,a,c,d,$,x,D;return t=o,s.charCodeAt(o)===78?(a=Ze,o++):(a=e,T===0&&k(ft)),a!==e?(S(),c=Z(),c!==e?(S(),d=Z(),d!==e?(S(),$=Z(),$!==e?(S(),x=Z(),x!==e?(S(),D=me(),D!==e?(L=t,t=O(c,d,$,x,D)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e),t}function Jn(){var t,a,c,d,$,x,D,_;return t=o,s.charCodeAt(o)===67?(a=je,o++):(a=e,T===0&&k(ar)),a!==e?(S(),c=Oe(),c!==e?(S(),d=Z(),d!==e?(S(),$=Z(),$!==e?(S(),x=fe(),x!==e?(S(),D=fe(),D!==e?(S(),_=me(),_!==e?(L=t,t=V(c,d,$,x,D,_)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e),t}function Qn(){var t,a,c,d;return t=o,s.charCodeAt(o)===91?(a=Ve,o++):(a=e,T===0&&k(lr)),a!==e?(S(),c=vr(),c!==e?(S(),s.charCodeAt(o)===93?(d=J,o++):(d=e,T===0&&k(ut)),d!==e?(L=t,t=ge(c)):(o=t,t=e)):(o=t,t=e)):(o=t,t=e),t}function Z(){var t,a;return t=o,a=Rt(),a!==e&&(L=t,a=le(a)),t=a,t}function Ir(){var t,a;return t=o,a=Rt(),a!==e&&(L=t,a=Tt(a)),t=a,t}function Rt(){var t,a,c,d,$,x;if(t=o,s.charCodeAt(o)===45?o++:T===0&&k(ht),a=[],pe.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(ae)),c!==e)for(;c!==e;)a.push(c),pe.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(ae));else a=e;if(a!==e){if(c=o,s.charCodeAt(o)===46?(d=We,o++):(d=e,T===0&&k(cr)),d!==e){if($=[],pe.test(s.charAt(o))?(x=s.charAt(o),o++):(x=e,T===0&&k(ae)),x!==e)for(;x!==e;)$.push(x),pe.test(s.charAt(o))?(x=s.charAt(o),o++):(x=e,T===0&&k(ae));else $=e;$!==e?(d=[d,$],c=d):(o=c,c=e)}else o=c,c=e;c===e&&(c=null),L=t,t=kt()}else o=t,t=e;return t}function fe(){var t,a,c;if(t=o,s.charCodeAt(o)===45?o++:T===0&&k(ht),a=[],pe.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(ae)),c!==e)for(;c!==e;)a.push(c),pe.test(s.charAt(o))?(c=s.charAt(o),o++):(c=e,T===0&&k(ae));else a=e;return a!==e?(L=t,t=kn()):(o=t,t=e),t}function S(){var t,a;for(t=[],rt.test(s.charAt(o))?(a=s.charAt(o),o++):(a=e,T===0&&k(pt));a!==e;)t.push(a),rt.test(s.charAt(o))?(a=s.charAt(o),o++):(a=e,T===0&&k(pt));return t}if(Lt=v(),Lt!==e&&o===s.length)return Lt;throw Lt!==e&&o<s.length&&k(Ln()),Rn(pr,ie<s.length?s.charAt(ie):null,ie<s.length?Tr(ie,ie+1):Tr(ie,ie))}return{SyntaxError:i,parse:l}}();Tn.SyntaxError.prototype.name="PeggySyntaxError";const sn=Tn.parse,an=50,mo=3;class yo extends EventTarget{constructor(r,l){super();oe(this,"componentClickEmitter",new nn);oe(this,"onComponentClick",this.componentClickEmitter.event);oe(this,"loadingComponentEmitter",new nn);oe(this,"onLoadComponent",this.loadingComponentEmitter.event);this.libraryLoader=r,this.colors=l}async renderItem(r,l,s={},f={flip:!1,rotation:0}){var e,u;switch(s.spice_get_voltage??(s.spice_get_voltage=""),s.spice_get_current??(s.spice_get_current=""),r.type){case"Wire":{const p=document.createElementNS("http://www.w3.org/2000/svg","line");p.setAttribute("x1",r.x1.toString()),p.setAttribute("y1",r.y1.toString()),p.setAttribute("x2",r.x2.toString()),p.setAttribute("y2",r.y2.toString()),p.setAttribute("stroke",this.colors[Fe.Wire]),l.appendChild(p);break}case"Line":{const p=document.createElementNS("http://www.w3.org/2000/svg","line");p.setAttribute("x1",r.x1.toString()),p.setAttribute("y1",r.y1.toString()),p.setAttribute("x2",r.x2.toString()),p.setAttribute("y2",r.y2.toString()),p.setAttribute("stroke",this.colors[r.layer]),r.properties.dash!=null&&p.setAttribute("stroke-dasharray",r.properties.dash),l.appendChild(p);break}case"Text":{if(r.properties.hide==="true")break;let v=r.text.replace(/@([\w#:]+)/g,(U,N)=>N.startsWith("#")&&N.endsWith(":net_name")?"":s[N]??U);if(v.startsWith("tcleval(")&&v.endsWith(")")){const U=v.substring(8,v.length-1);v=await po(`string cat "${U}"`).catch(N=>(console.warn("tcleval failed:",U,N),""))}const g=["ipin","opin","iopin","label"].includes(s.type??""),y=v.split(`
`),E=r.properties.layer!=null?Number(r.properties.layer):g?Fe.Wire:Fe.Text,b=r.properties.hcenter==="true",C=r.properties.vcenter==="true",P=(r.rotation+f.rotation)%4,B=P===2||P===1;let M=B;r.mirror===1&&(M=!M),f.flip&&(M=!M);for(let U=0;U<y.length;U++){const N=document.createElementNS("http://www.w3.org/2000/svg","text"),Y=[`translate(${r.x},${r.y})`];r.rotation!==0&&Y.push(`rotate(${r.rotation*90})`),r.mirror===1&&Y.push("scale(-1, 1)");const re=B?y.length-U-1:U;Y.push(`translate(0, ${re*r.vSize*an})`),B&&Y.push("scale(1, -1)"),M&&Y.push("scale(-1, 1)"),N.setAttribute("transform",Y.join(" ")),N.setAttribute("font-size",(r.vSize*an).toString()),N.setAttribute("fill",this.colors[E]),b?N.setAttribute("text-anchor","middle"):M&&N.setAttribute("text-anchor","end"),N.setAttribute("alignment-baseline",C?"middle":B?"after-edge":"before-edge"),N.textContent=y[U],l.appendChild(N)}break}case"Rectangle":{if((((e=r.properties)==null?void 0:e.flags)??"").split(",").includes("graph"))break;if(r.properties.pinnumber)for(let v=0;v<255;v++){const g=`#${v}:pinnumber`;if(s[g]==null){s[g]=r.properties.pinnumber;break}}if(r.properties.image_data!=null){const v=document.createElementNS("http://www.w3.org/2000/svg","image");v.setAttribute("x",Math.min(r.x1,r.x2).toString()),v.setAttribute("y",Math.min(r.y1,r.y2).toString()),v.setAttribute("width",Math.abs(r.x2-r.x1).toString()),v.setAttribute("height",Math.abs(r.y1-r.y2).toString()),v.setAttribute("href","data:image/png;base64,"+r.properties.image_data),v.style.opacity=r.properties.alpha??"1",l.appendChild(v)}else{const v=document.createElementNS("http://www.w3.org/2000/svg","rect");v.setAttribute("x",Math.min(r.x1,r.x2).toString()),v.setAttribute("y",Math.min(r.y1,r.y2).toString()),v.setAttribute("width",Math.abs(r.x2-r.x1).toString()),v.setAttribute("height",Math.abs(r.y1-r.y2).toString()),v.setAttribute("stroke",this.colors[r.layer]),r.properties.fill!=="false"&&v.setAttribute("fill",this.colors[r.layer]),l.appendChild(v)}break}case"Polygon":{const p=document.createElementNS("http://www.w3.org/2000/svg","polygon"),v=r.points.map(g=>`${g.x},${g.y}`).join(" ");p.setAttribute("points",v),p.setAttribute("fill","none"),r.properties.fill==="true"&&p.setAttribute("fill",this.colors[r.layer]),p.setAttribute("stroke",this.colors[r.layer]),l.appendChild(p);break}case"Arc":{if(Math.abs(r.sweepAngle)>=360){const p=document.createElementNS("http://www.w3.org/2000/svg","circle");p.setAttribute("cx",r.centerX.toString()),p.setAttribute("cy",r.centerY.toString()),p.setAttribute("r",r.radius.toString()),p.setAttribute("fill","none"),p.setAttribute("stroke",this.colors[r.layer]),l.appendChild(p)}else{const p=document.createElementNS("http://www.w3.org/2000/svg","path"),v=-r.startAngle,g=-r.sweepAngle,y=r.centerX+r.radius*Math.cos(v*Math.PI/180),E=r.centerY+r.radius*Math.sin(v*Math.PI/180),b=r.centerX+r.radius*Math.cos((v+g)*Math.PI/180),C=r.centerY+r.radius*Math.sin((v+g)*Math.PI/180),P=g>180?1:0,B=g>0?1:0,M=`M ${y} ${E} A ${r.radius} ${r.radius} 0 ${P} ${B} ${b} ${C}`;p.setAttribute("d",M),p.setAttribute("fill","none"),p.setAttribute("stroke",this.colors[r.layer]),l.appendChild(p)}break}case"Component":{const p=((u=r.symbolReference.split("/").pop())==null?void 0:u.split(".").shift())??r.symbolReference;this.loadingComponentEmitter.fire(p);const v=document.createElementNS("http://www.w3.org/2000/svg","g");v.dataset.symbol=r.symbolReference;const g=[`translate(${r.x},${r.y})`];r.rotation!==0&&g.push(`rotate(${r.rotation*90})`),r.flip&&g.push("scale(-1, 1)"),r.properties.spice_ignore==="true"&&(v.style.filter="grayscale(1)",v.style.opacity="0.5"),v.setAttribute("transform",g.join(" ")),v.setAttribute("tabindex","0"),l.appendChild(v);const y=r.symbolReference.endsWith(".sym")?r.symbolReference:r.symbolReference+".sym",E=()=>{this.componentClickEmitter.fire(y.replace(/\.sym$/,".sch"))};v.addEventListener("click",E),v.addEventListener("touchend",E);try{const b=await this.libraryLoader.load(y),C=sn(b),P={...r.properties,symname:p};for(const B of C)await this.renderItem(B,v,P,{flip:r.flip?!f.flip:f.flip,rotation:(f.rotation+r.rotation)%4})}catch(b){console.error("Error loading component",y,b)}break}case"GlobalProperties":Object.assign(s,r.properties);break;case"Version":case"Verilog":case"Spice":case"VHDL":case"TEDAx":break;default:console.warn("Unsupported object type",r)}}renderJunctions(r,l){const s=new Map;for(const e of r){const u=`${e.x1},${e.y1}`,p=`${e.x2},${e.y2}`;s.set(u,(s.get(u)??0)+1),s.set(p,(s.get(p)??0)+1)}const f=new Set;for(const[e,u]of s)u>=3&&f.add(e);for(const e of r)for(const u of r)e!==u&&(on({x:u.x1,y:u.y1},e)&&f.add(`${u.x1},${u.y1}`),on({x:u.x2,y:u.y2},e)&&f.add(`${u.x2},${u.y2}`));for(const e of f){const[u,p]=e.split(",").map(Number),v=document.createElementNS("http://www.w3.org/2000/svg","circle");v.setAttribute("cx",u.toString()),v.setAttribute("cy",p.toString()),v.setAttribute("r",mo.toString()),v.setAttribute("fill",this.colors[Fe.Wire]),l.appendChild(v)}}async render(r,l){const s=sn(await this.libraryLoader.load(r));l.innerHTML="",l.setAttribute("width","0"),l.setAttribute("height","0");for(const u of s)await this.renderItem(u,l,{});const f=s.filter(u=>u.type==="Wire");this.renderJunctions(f,l);const e=l.getBBox({stroke:!0});l.setAttribute("viewBox",`${e.x} ${e.y} ${e.width} ${e.height}`),l.setAttribute("width",`${e.width}`),l.setAttribute("height",`${e.height}`)}}const wo=["#000000","#00ccee","#3f3f3f","#cccccc","#88dd00","#bb2200","#00ccee","#ff0000","#ffff00","#ffffff","#ff00ff","#00ff00","#0000cc","#aaaa00","#aaccaa","#ff7777","#bfff81","#00ffcc","#ce0097","#d2d46b","#ef6158","#fdb200"],ln=wo;var bo=mn("<div class=xschem><div></div><svg xmlns=http://www.w3.org/2000/svg>");function xo(n){let i,r;const[l,s]=Nt("Loading..."),[f,e]=Nt(!1),u=new yo($r,ln);return u.onLoadComponent.listen(p=>{s(`Loading... ${p}`)}),u.onComponentClick.listen(async p=>{var v;await $r.fileExists(p)&&((v=n.onComponentClick)==null||v.call(n,p))}),un(async()=>{if(!n.url||!i)return;r||(r=so(i,{maxZoom:10,minZoom:.1}));const p=n.url;s(`Loading... ${p}`),e(!1),p.startsWith("https://")&&($r.baseURL=p.substring(0,p.lastIndexOf("/")+1));try{r.pause(),await u.render(p,i),s(""),e(!0);const v=i.getBBox();r.showRectangle(new DOMRect(0,0,v.width,v.height)),r.resume()}catch(v){console.error("Error loading",p,v),s(`Error loading ${p}: ${v.toString()}`)}},[n.url]),(()=>{var p=bo(),v=p.firstChild,g=v.nextSibling;p.style.setProperty("height","0"),yn(v,l);var y=i;return typeof y=="function"?vi(y,g):i=g,Ue(E=>{var b=ln[Fe.Background],C=f()?"visible":"hidden";return b!==E.e&&((E.e=b)!=null?p.style.setProperty("background-color",b):p.style.removeProperty("background-color")),C!==E.t&&((E.t=C)!=null?g.style.setProperty("visibility",C):g.style.removeProperty("visibility")),E},{e:void 0,t:void 0}),p})()}function $o(){const[n,i]=Nt();oi(()=>{const l=new URLSearchParams(window.location.search).get("file");i(l),window.addEventListener("popstate",s=>{var e;const f=((e=s.state)==null?void 0:e.path)??new URLSearchParams(window.location.search).get("file");i(f)})});const r=l=>{const s=new URL(window.location.href);s.searchParams.set("file",l),i(l),window.history.pushState({path:l},"",s.toString())};return[Dt(Br,{get when(){return n()==null},get children(){return Dt(wi,{})}}),Dt(Br,{get when(){return n()},children:l=>Dt(xo,{get url(){return l()},onComponentClick:r})})]}const Ao=document.querySelector("footer");Ao.innerHTML=`
  xschem-viewer revision 
  <a href="https://github.com/TinyTapeout/xschem-viewer/commit/ddd97ca">ddd97ca</a>
  built 2024-12-11T17:41:48.107Z.
`;hi($o,document.getElementById("root"));